<div id="todo" class="grid grid-cols-1 xl:grid-cols-2 min-h-screen  p-6 gap-6">

  <!-- IZQUIERDA: FORMULARIO -->
  <div class="bg-white rounded-2xl shadow-md p-6">
    <h2 class="text-xl font-bold text-orange-700 mb-4">Nueva Cotizaci√≥n</h2>

    <!-- Datos del cliente -->
    <div class="mb-4">
      <label class="block text-sm font-medium mb-1">Cliente</label>
      <input type="text" [(ngModel)]="cliente" placeholder="Nombre del cliente"
        class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-400 outline-none" />
    </div>

    <!-- Descripci√≥n -->
    <div class="mb-4">
      <label class="block text-sm font-medium mb-1">Descripci√≥n</label>
      <textarea [(ngModel)]="descripcion" rows="3" placeholder="Detalles del pedido"
        class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-400 outline-none"></textarea>
    </div>

    <!-- Bot√≥n a√±adir prenda -->
    <button (click)="abrirModal()" class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600">
      A√±adir prenda
    </button>

    <!-- Tabla de prendas -->
    <div *ngIf="prendas.length > 0" class="mt-4">
      <h3 class="font-semibold mb-2">Prendas agregadas</h3>
      <table class="w-full border border-gray-300 rounded-lg">
        <thead class="bg-orange-100">
          <tr>
            <th class="py-2">Cantidad</th>
            <th class="py-2">Talla</th>
            <th class="py-2">Sexo</th>
            <th class="py-2">Precio</th>
            <th class="py-2">Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of prendas" class="text-center border-t">
            <td>{{ p.cantidad }}</td>
            <td>{{ p.talla }}</td>
            <td>{{ p.sexo }}</td>
            <td>{{ p.precio | currency:'BOB' }}</td>
            <td>{{ p.cantidad * p.precio | currency:'BOB' }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Total -->
    <div class="mt-4 text-right text-lg font-semibold text-orange-700">
      Total: {{ calcularTotal() | currency:'BOB' }}
    </div>
  </div>

  <!-- DERECHA: BORRADOR -->
  <!-- DERECHA: COTIZACI√ìN EN BORRADOR -->
  <div  class="flex justify-center bg-gray-50  rounded-2xl shadow-md">
    <div id="cotizacion-preview" class="bg-white w-full max-w-2xl rounded-2xl shadow-lg p-8 font-sans text-gray-800">

      <!-- Encabezado -->
      <div class="flex items-center justify-between border-b-2 border-orange-400 pb-4 mb-4">
        <div class="flex items-center space-x-4">
          <!-- Logo din√°mico -->
          <div class="flex flex-col items-center space-y-2">
            <img
              [src]="logoPreview || 'assets/Recurso1.png'"
              alt="Logo empresa"
              class="w-20 h-20 object-contain"
            />

            <!-- Bot√≥n para subir logo -->
            <label 
              for="logoInput"
              class="bg-orange-500 hover:bg-orange-600 text-white text-xs px-3 py-1 rounded cursor-pointer"
              id="CambiarLogoBtn"
              >
              Cambiar logo
            </label>
            <input
              id="logoInput"
              type="file"
              accept="image/png"
              class="hidden"
              (change)="onLogoSelected($event)"
            />
          </div>

          <div>
            <h1 class="text-2xl font-bold text-orange-600 leading-tight">{{empresa}}</h1>
            <p class="text-sm text-gray-600">Cotizaci√≥n de Pedido</p>
          </div>
        </div>
        <div class="text-right text-sm text-gray-500">
          <p>Fecha: {{ fechaActual }}</p>
        </div>
      </div>

      <!-- Datos principales -->
      <div class="mb-6">
        <p class="text-sm"><strong class="text-gray-700">Cliente:</strong> {{ cliente || '---' }}</p>
        <p class="text-sm"><strong class="text-gray-700">Descripci√≥n:</strong> {{ descripcion || '---' }}</p>
      </div>

      <!-- Tabla de prendas -->
      <div *ngIf="prendas.length > 0; else sinPrendas">
        <table class="w-full border-collapse text-sm">
          <thead>
            <tr class="bg-orange-100 text-orange-700 uppercase text-xs">
              <th class="py-2 px-3 border border-gray-200">Cantidad</th>
              <th class="py-2 px-3 border border-gray-200">Talla</th>
              <th class="py-2 px-3 border border-gray-200">Sexo</th>
              <th class="py-2 px-3 border border-gray-200">Precio</th>
              <th class="py-2 px-3 border border-gray-200">Subtotal</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of prendas" class="border-b border-gray-200 hover:bg-orange-50 transition">
              <td class="py-2 px-3 text-center">{{ p.cantidad }}</td>
              <td class="py-2 px-3 text-center">{{ p.talla }}</td>
              <td class="py-2 px-3 text-center">{{ p.sexo }}</td>
              <td class="py-2 px-3 text-center">{{ p.precio | currency:'BOB' }}</td>
              <td class="py-2 px-3 text-center font-medium text-orange-600">
                {{ p.cantidad * p.precio | currency:'BOB' }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <ng-template #sinPrendas>
        <p class="text-center text-gray-400 italic py-8">No se han agregado prendas a√∫n.</p>
      </ng-template>

      <!-- Total -->
      <div class="flex justify-end items-center mt-6 border-t border-orange-200 pt-4">
        <span class="text-lg font-semibold text-gray-700 mr-2">Total:</span>
        <span class="text-xl font-bold text-orange-600">{{ calcularTotal() | currency:'BOB' }}</span>
      </div>

      <!-- Bot√≥n imprimir -->
      <div id="btn-imprimir" class="text-center mt-6">
        <button (click)="imprimir()"
          class="bg-green-500 hover:bg-green-600 text-white font-semibold px-5 py-2.5 rounded-lg shadow transition-all">
          üñ®Ô∏è Imprimir Cotizaci√≥n
        </button>
      </div>
    </div>
  </div>


  <!-- MODAL DE A√ëADIR PRENDA -->
  <div *ngIf="mostrarModal" class="fixed inset-0 bg-opacity-40 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl shadow-lg w-80">
      <h3 class="text-lg font-bold mb-3 text-orange-600">A√±adir prenda</h3>

      <div class="mb-2">
        <label class="block text-sm font-medium">Cantidad</label>
        <input type="number" [(ngModel)]="nuevaPrenda.cantidad"
          class="w-full border border-gray-300 rounded-lg px-3 py-1" />
      </div>

      <div class="mb-2">
        <label class="block text-sm font-medium">Talla</label>
        <input type="text" [(ngModel)]="nuevaPrenda.talla" class="w-full border border-gray-300 rounded-lg px-3 py-1" />
      </div>

      <div class="mb-2">
        <label class="block text-sm font-medium">Sexo</label>
        <select [(ngModel)]="nuevaPrenda.sexo" class="w-full border border-gray-300 rounded-lg px-3 py-1">
          <option value="Hombre">Hombre</option>
          <option value="Mujer">Mujer</option>
          <option value="Ni√±o">Ni√±o</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="block text-sm font-medium">Precio unitario (BOB)</label>
        <input type="number" [(ngModel)]="nuevaPrenda.precio"
          class="w-full border border-gray-300 rounded-lg px-3 py-1" />
      </div>

      <div class="flex justify-end space-x-2">
        <button (click)="cerrarModal()" class="bg-gray-300 px-3 py-1 rounded-lg">Cancelar</button>
        <button (click)="guardarPrenda()" class="bg-orange-500 text-white px-3 py-1 rounded-lg hover:bg-orange-600">
          Guardar
        </button>
      </div>
    </div>
  </div>
</div>